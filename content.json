[{"title":"使用Clonezilla（再生龙）克隆Ubuntu系统","path":"/clonezilla-usage.html","text":"使用Clonezilla的原因这次要进行服务器系统迁移，即将一个硬盘上的全部内容搬迁到另一个新的硬盘，于是我想到了可以用再生龙去实现迁移系统。 其实大约在一年半前我使用过再生龙进行了同样的操作。那次迁移过程比较顺利，没有遇到什么坑，所以没有去写这个博客。 但这次运气不好给我碰上了，导致我折腾了一整个晚上（几乎通宵）才把系统迁移完成。故写一篇来记录自己的踩坑情况和解决方案。 Clonezilla介绍再生龙（Clonezilla）是一个免费的灾难恢复、硬盘克隆、硬盘映像档制作的部署和解决方案，由中国台湾的国家高速网络与计算中心（NCHC）所开发，以GNU通用公共许可协议（GPL）发布。 再生龙基于Partimage，吸取了Norton Ghost和Partition Image的优点，即不仅支持对整个硬盘系统进行克隆，而且也可以克隆单个的分区，这种灵活性更能满足各种使用者的需要，此外支持多种的操作系统与文件系统也是其强大之处。 相关链接如下： Clonezilla官方网址：http://www.clonezilla.org/ Clonezilla镜像下载：https://clonezilla.nchc.org.tw/clonezilla-live/download/ 制作Clonezilla启动盘注：以下步骤为本人操作过程，请根据自己实际情况调整方法。 在制作启动盘前，需要以下软件和硬件： 一块容量16GB或以上的USB硬盘 Clonezilla镜像文件（为.iso文件） 制作启动盘的软件（本例为Rufus） 其中Clonezilla镜像文件下载步骤为：点击打开镜像下载链接后，在“分支”列中点击“穩定-替代版”，选择“CPU 架構”为“amd64”，“檔案類別”为“iso”，再点击下载按钮。 下载好镜像文件后，插入USB硬盘，打开Rufus，选择镜像文件和USB硬盘，文件系统为FAT32。点击“开始”按钮直接开始制作启动盘。 进度条提示完成后直接退出Rufus并安全弹出USB硬盘。至此再生龙的启动盘制作完成。 启动Clonezilla并迁移注1：以下步骤为本人操作过程，请根据自己实际情况调整方法。 注2：本文的迁移操作涉及两块硬盘设备之间的直接迁移。若您有多余的USB硬盘或外接硬盘盒，可参考该文章：clonezilla(再生龙)克隆linux系统 操作指南 重启服务器，键盘按下DEL或F1键，进入BIOS，启动项选择装有Clonezilla的USB硬盘，然后再次重启。 成功进入Clonezilla系统后，选择“Clonezilla Live (VGA 800*600)”，或“Clonezilla Live (VGA 800*600, To RAM)”，等待片刻。 完成初始化后，选择语言栏为“简体中文”，键盘布局选择“不改变”。随后进入选定模式，选择“使用再生龙” - “device-device” - “Beginner（初学者模式，推荐）” - “disk_to_local_disk”。 之后再生龙会自动检测存在的硬盘列表，并列出所有可用的硬盘名称和ID。在“母盘”选项中选择原来安装Ubuntu系统的旧硬盘，“目标盘”选择自己要迁移到的新硬盘。后续的参数选择默认即可。 特别警告：千万别选错了盘！迁移操作会将目标盘内容全部擦除！ 参数选择后，再生龙会非常贴心的警告你多次，尤其是第一步会警告你两次，防止你误操作。 之后等待它全部工作完成即可，直到poweroff操作将机器关机后，就可以把旧硬盘取出来直接用新硬盘跑系统啦。 踩坑记录与解决方案上面的迁移步骤很简单，但是我在选择“目标盘”的时候碰到了一个问题：再生龙找了一段时间提示“找不到磁盘，或者找不到未被挂载的磁盘”，然后报错退出。 翻阅了各种资料，发现没有相关的情况。于是我咨询了下ChatGPT，给出的答案解决了我的问题。故在此放出解决步骤： 在Clonezilla界面里按Ctrl+C或选择“进入命令列”，进入Ubuntu命令行 执行下方代码，完成后执行clonezilla回到操作界面 重新开始“disk_to_local_disk”的迁移步骤 12345678sudo -ilsblk -e7cat /proc/partitions# 假设目标盘是 /dev/nvme1n1（请按 lsblk 实际显示替换）wipefs -fa /dev/nvme1n1 # 仅在确认目标盘可全盘抹除时执行！# 可选更彻底（同时清 GPT/MBR 元数据）：sgdisk --zap-all /dev/nvme1n1partprobe 至此“目标盘”能够识别到自己要迁移到的新硬盘了。 参考来源 使用Clonezilla(再生龙)克隆、恢复Linux系统 clonezilla(再生龙)克隆linux系统 操作指南 使用Clonezilla（”再生龙”）对Linux系统硬盘进行镜像和克隆","comments":true},{"title":"在Ubuntu 22.04上安装MI50显卡驱动和ROCm软件","path":"/mi50-rocm-install.html","text":"注意事项 我的安装环境是Ubuntu 22.04.5，内核版本6.8.0-hwe。 对于家用主板，需要两个PCIe x16插槽，如X（AMD）板、Z（Intel）板，以及一部分B板。 在主板内设置Above 4G Decoding开启，且需要带上亮机卡，否则无法点亮。 由于MI50的架构原因（GCN5.1，gfx906），ROCm 6.4及以后的版本无法使用，建议安装6.3.3或6.3.4版本。 安装流程代码12345678910111213# 卸载ROCm和AMD驱动，未安装过的直接跳过该步骤amdgpu-install --uninstallapt-get purge amdgpu-install &amp;&amp; apt update# 安装ROCm和AMD驱动wget https://repo.radeon.com/amdgpu-install/6.3.4/ubuntu/jammy/amdgpu-install_6.3.60304-1_all.debapt-get install ./amdgpu-install_6.3.60304-1_all.deb &amp;&amp; apt updateapt install amdgpu-dkms rocmusermod -a -G video $LOGNAMEusermod -a -G render $LOGNAMErocm-smi # 查看AMD显卡信息命令，重启后执行以验证安装 以上步骤完成后需要重启。重启后还需进入BIOS设置CSM（兼容性模块支持）为关闭。 注意：亮机卡不要拔出来！！！ Q1：为什么要关闭CSMAMD的显卡要被ROCm软件识别到的前提是关闭CSM，如果打开了请进入BIOS将这个选项设置为关闭。 Q2：为什么不要拔出亮机卡因为我拔出来之后发现无法识别到MI50了，由于不知道原因只能先装回去并重装驱动。 服务器部署不太清楚情况，应该有没有也没关系。 2025.06.08注：已经查明白了，我的华硕X570-F在关机后拔出亮机卡再开机会自动将CSM打开，并且无法进入BIOS盲改。","comments":true},{"title":"在Ubuntu 22.04.1 LTS上安装Realtek 8852BE网卡驱动","path":"/ubuntu-rtw89.html","text":"前言在双十一活动上，我看中了Lenovo ThinkBook 16+（Intel i5版本挺便宜的）。 买下来到货之后，便心血来潮装了个Ubuntu 22.04作为编写blog的地方，结果发现Ubuntu没有Windows 11有的wifi选项，只有以太网（有线网络）能用。 摸索在装之前，我拿了旧电脑进行安装尝试，那边是有wifi选项的。（实际上这不是我的电脑，后面被我爸呵斥停止安装了） 没有了wifi选项，让我怀疑是不是Ubuntu 22.04所配置的内核（Linux Kernel 5.15.0-43-generic）没有与该电脑的无线网卡对应的驱动。 于是我先换回Windows 11系统，查看电脑配置的网卡。 一看是Intel Realtek 8852BE，心想，linux绝对不可能有这类网卡驱动了。 然后我去度娘、CSDN、Google等处，都让我自己用以太网自己安装网卡驱动。TMD 这怎么可能啊 学校的有线网络服务比我流量卡100G流量费还贵 带宽还烂 于是我只能在windows系统自己找办法安装所需了。 运气很好，我很快在GitHub上找到了与我电脑网卡型号有关的repo（度娘直接搜Intel Realtek 8852BE）：lwfinger/rtw89。 安装驱动让我们来看看这个repo的内容： 12345678910111213## A repo for the newest Realtek rtlwifi codes.This branch was created from the version merged into the wireless-drivers-next repo, which is in the 5.16 kernel. IF YOU USE DRIVERS FROM THIS REPO FOR KERNELS 5.16+, TOU MUST BLACKLIST THE KERNEL VERSIONS!!!! FAILING TO DO THIS WILL RESULT IN ALL MANNER OF STRANGE ERRORS.This code will build on any kernel 5.7 and newer as long as the distro has not modified any of the kernel APIs. IF YOU RUN UBUNTU, YOU CAN BE ASSURED THAT THE APIs HAVE CHANGED. NO, I WILL NOT MODIFY THE SOURCE FOR YOU. YOU ARE ON YOUR OWN!!!!!I am working on fixing builds on older kernels.This repository includes drivers for the following card:Realtek 8852AE, 8852BE, and 8853CEIf you are looking for a driver for chips such as RTL8188EE, RTL8192CE, RTL8192CU, RTL8192DE, RTL8192EE, RTL8192SE, RTL8723AE, RTL8723BE, or RTL8821AE, these should be provided by your kernel. If not, then you should go to the Backports Project (https://backports.wiki.kernel.org/index.php/Main_Page) to obtain the necessary code. 省流：仅适配Realtek 8852AE, 8852BE, 8853CE这仨无线网卡型号，并且内核版本要在5.7及以上，5.16及以下（因为5.16以上版本有可能会出现莫名其妙的bug）。 再来看看安装步骤： 1234567891011121314151617181920212223242526## RequirementsYou will need to install &quot;make&quot;, &quot;gcc&quot;, &quot;kernel headers&quot;, &quot;kernel build essentials&quot;, and &quot;git&quot;.For Ubuntu: You can install them with the following commandsudo apt-get updatesudo apt-get install make gcc linux-headers-$(uname -r) build-essential git## Installation### For all distros:git clone https://github.com/lwfinger/rtw89.gitcd rtw89makesudo make install## Installation with module signing for SecureBoot### For all distros:git clone https://github.com/lwfinger/rtw89.gitcd rtw89makesudo make sign-install 大概意思是，安装驱动前你得先安装make, gcc, kernel headers, kernel build essentials, git这五样东西。 然后我试了一下： 12345$ make --versionmake: 未找到命令$ gcc --versiongcc: 未找到命令 又要我自己一个人手动安装了……还好我自己就有一个ubuntu服务器，可以手动下载deb包并拷贝过来。 经过调查，安装的核心都在build-essential上，我可以通过build-essential进行依赖包递归搜索。 1234567891011121314151617181920212223242526272829303132#!usr/bin/bashlogfile=&quot;./apt-downloaded.log&quot;ret=&quot;&quot;function getDepends() &#123; echo &quot;fileName is&quot; $1&gt;&gt;$logfile # use tr to del &lt; &gt; ret=`apt-cache depends $1|grep Depends |cut -d: -f2 |tr -d &quot;&lt;&gt;&quot;` echo $ret|tee -a $logfile&#125;# 需要获取其所依赖包的包libs=&quot;build-essential&quot;# download libs dependen. deep in 5# downloaded files will be saved in /var/cache/apt/archivesi=0while [ $i -lt 5 ] ;do let i++ echo $i # download libs newlist=&quot; &quot; for j in $libs do added=&quot;$(getDepends $j)&quot; newlist=&quot;$newlist $added&quot; apt-get install $added --reinstall -d -y done libs=$newlistdone 就这样，所有依赖包安装完成了，把所有安装好的包复制到任意路径中，输入以下命令运行： 12345# 注意事项：# 1.请不要使用dpkg -i命令，此命令不会按照依赖顺序安装，运行后不仅会报出依赖包未安装的错误，还会把apt搞崩，严重不推荐；# 2.请在apt install前加入sudo命令以root权限运行，或者直接登录root账号，这里就不多说了；# 3.在安装包名称前请加上路径名称，如./xxx，否则apt会从/var/cache/apt/archives上查找安装包，导致文件不存在的报错。$ sudo apt install ./build-essential* 安装完成后，再把自己提前准备好的rtw89文件夹复制到任意路径中，然后再运行上面安装步骤中的Installation下的命令，等待安装完成。 当你在设置窗口中看到以下东西时，说明你已经成功安装了Realtek 8852BE的网卡驱动啦！","comments":true},{"title":"Hello World","path":"2022/10/29/hello-world/","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","comments":false}]